<nav class="bg-[#f0f0e8] shadow-md py-4">
    <div class="container mx-auto px-4 flex items-center justify-between">
        <a href="{% url 'home' %}" class="text-2xl font-bold text-[#3C4142]">EMS</a>
        <div class="hidden md:flex items-center gap-6">
            {% if user.is_authenticated %}
            <a href="/" class="text-[#5e4a3a] hover:text-[#9aac7f] font-semibold transition-all duration-300">Home</a>
            <a href="/profile" class="text-[#5e4a3a] hover:text-[#9aac7f] font-semibold transition-all duration-300"
                >Profile</a
            >
            <a href="/dashboard" class="text-[#5e4a3a] hover:text-[#9aac7f] font-semibold transition-all duration-300"
                >Dashboard</a
            >
            {% else %}
            <a
                href="{% url 'signin' %}"
                class="py-2 px-4 text-[#5e4a3a] hover:text-[#9aac7f] font-semibold transition-all duration-300 border border-[#5e4a3a] hover:border-[#9aac7f] rounded-lg"
                >Sign in</a
            >
            <a
                href="{% url 'signup' %}"
                class="py-2 px-4 bg-[#9aac7f] text-white rounded-lg hover:bg-[#5e4a3a] transition-all duration-300 shadow-md hover:shadow-lg font-semibold"
                >Get Started</a
            >
            {% endif %}
        </div>

        {% if user.is_authenticated %}
        <button
            onclick="handleLogout()"
            class="hidden md:block py-2 px-4 bg-[#9aac7f] text-white rounded-lg hover:bg-[#5e4a3a] transition-all duration-300 shadow-md hover:shadow-lg font-semibold"
        >
            Logout
        </button>
        {% endif %}

        <div x-data="{ open: false }" class="md:hidden">
            <button @click="open = !open" class="text-[#5e4a3a] focus:outline-none text-2xl">
                <i :class="open ? 'fas fa-xmark' : 'fas fa-bars'"></i>
            </button>
            <div
                x-show="open"
                @click.away="open = false"
                class="absolute left-0 w-full bg-[#f0f0e8] shadow-md z-40 rounded-3xl mt-2"
                x-transition:enter="transition ease-out duration-300"
                x-transition:enter-start="opacity-0 transform -translate-y-10"
                x-transition:enter-end="opacity-100 transform translate-y-0"
                x-transition:leave="transition ease-in duration-300"
                x-transition:leave-start="opacity-100 transform translate-y-0"
                x-transition:leave-end="opacity-0 transform -translate-y-10"
            >
                <div class="container py-6">
                    <ul class="flex flex-col gap-4 mb-6">
                        {% if user.is_authenticated %}
                        <li>
                            <a
                                href="/"
                                class="block py-2 px-4 text-[#5e4a3a] hover:text-[#9aac7f] font-semibold transition-all duration-300 hover:bg-[#9aac7f]/10 rounded-lg"
                                @click="open = false"
                            >
                                Home
                            </a>
                        </li>
                        <li>
                            <a
                                href="/profile"
                                class="block py-2 px-4 text-[#5e4a3a] hover:text-[#9aac7f] font-semibold transition-all duration-300 hover:bg-[#9aac7f]/10 rounded-lg"
                                @click="open = false"
                            >
                                Profile
                            </a>
                        </li>
                        <li>
                            <a
                                href="/dashboard"
                                class="block py-2 px-4 text-[#5e4a3a] hover:text-[#9aac7f] font-semibold transition-all duration-300 hover:bg-[#9aac7f]/10 rounded-lg"
                                @click="open = false"
                            >
                                Dashboard
                            </a>
                        </li>
                        {% endif %}
                    </ul>
                    <div class="flex flex-col gap-3 px-4">
                        {% if not user.is_authenticated %}
                        <a
                            href="{% url 'signin' %}"
                            class="w-full py-3 text-[#5e4a3a] hover:text-[#9aac7f] font-semibold transition-all duration-300 hover:bg-[#9aac7f]/10 rounded-lg border border-[#5e4a3a] hover:border-[#9aac7f] text-center"
                            @click="open = false"
                        >
                            Sign in
                        </a>
                        <a
                            href="{% url 'signup' %}"
                            class="w-full py-3 bg-[#9aac7f] text-white rounded-lg hover:bg-[#5e4a3a] transition-all duration-300 shadow-md hover:shadow-lg font-semibold text-center"
                            @click="open = false"
                        >
                            Get Started
                        </a>
                        {% else %}
                        <button
                            onclick="handleLogout()"
                            class="w-full py-3 bg-[#9aac7f] text-white rounded-lg hover:bg-[#5e4a3a] transition-all duration-300 shadow-md hover:shadow-lg font-semibold"
                        >
                            Logout
                        </button>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script>
    function handleLogout() {
        $.ajax({
            url: '{% url 'logout' %}',
            type: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',
            },
            success: function(data) {
                if (data.success) {
                    Swal.fire({
                        title: 'Success!',
                        text: 'You have been logged out successfully.',
                        icon: 'success',
                        confirmButtonText: 'OK'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href = '{% url 'home' %}';
                        }
                    });
                } else {
                    Swal.fire({
                        title: 'Error!',
                        text: 'Logout failed: ' + data.message,
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                }
            },
            error: function(xhr, status, error) {
                Swal.fire({
                    title: 'Error!',
                    text: 'Logout failed: An error occurred.',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
            }
        });
    }
</script>

