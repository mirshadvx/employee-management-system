{% load dashboard_filters %}
<div class="bg-[#8FA68E]/5 rounded-lg p-1">
    <div class="bg-white rounded-lg overflow-hidden shadow-sm">
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead class="bg-[#E8DDD4]">
                    <tr>
                        {% for field in columns %}
                        <th class="px-6 py-3 text-left text-[#3C4142] font-semibold">{{ field.label }}</th>
                        {% endfor %} {% if selected_department %}
                        <th class="px-6 py-3 text-left text-[#3C4142] font-semibold">Actions</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% if not selected_department %}
                    <tr>
                        <td class="px-6 py-8 text-center text-[#8FA68E]" colspan="{{ columns|length|add:1 }}">
                            Please select a department to view employees.
                        </td>
                    </tr>
                    {% elif employees|length == 0 %}
                    <tr>
                        <td class="px-6 py-8 text-center text-[#8FA68E]" colspan="{{ columns|length|add:1 }}">
                            {% if search_term %} No employees found matching your search criteria. {% else %} No employees
                            found in this department. {% endif %}
                        </td>
                    </tr>
                    {% else %} {% for employee in employees %}
                    <tr class="border-b border-[#8FA68E]/10 hover:bg-[#E8DDD4]/20 transition-colors">
                        {% for field in columns %}
                        <td class="px-6 py-4 text-[#3C4142] font-medium">
                            {{ employee.field_data|lookup:field.label|default:'-' }}
                        </td>
                        {% endfor %}
                        <td class="px-6 py-4 flex gap-2">
                            <a
                                href="{% url 'edit_employee' employee_id=employee.id %}"
                                class="text-[#8FA68E] hover:text-[#3C4142] transition-colors"
                                title="Edit"
                            >
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        stroke-width="2"
                                        d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"
                                    ></path>
                                </svg>
                            </a>
                            <form
                                action="{% url 'delete_employee' employee_id=employee.id %}"
                                method="POST"
                                onsubmit="return confirm('Are you sure you want to delete this employee?')"
                            >
                                {% csrf_token %}
                                <button
                                    type="submit"
                                    class="text-red-500 hover:text-red-700 transition-colors"
                                    title="Delete"
                                >
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5-4h4M7 7h10m-10 0V5a2 2 0 012-2h4a2 2 0 012 2v2"
                                        ></path>
                                    </svg>
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %} {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
